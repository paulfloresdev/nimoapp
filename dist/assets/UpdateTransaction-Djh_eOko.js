import{h as Ze,u as ea,a as aa,r as s,b as ze,i as ta,c as Pe,d as Fe,j as a,D as b,f as p,e as Oe,s as Ae,k as De}from"./index-DKY2NX35.js";import{c as sa,a as la}from"./combos-D7eekNR2.js";import{TransactionField as ra}from"./TransactionDetail-DP4fpMKl.js";import{s as w,l as f}from"./chunk-2GIFKCNQ-y7tds759.js";import{t as qe}from"./chunk-RIE4DNUQ-Ba9WOTQ8.js";import{r as na,a as Ee}from"./chunk-6NGXL2PC-Ds8FGwlY.js";import"./Formatters-G7kRJght.js";import"./TransactionCard-4OsSp7vu.js";import"./chunk-MW56SEHC-B-JqqJfx.js";const y="https://nimo-api.paulflores.site",ga=()=>{var W,Y,Z,ee,ae,te,se,le,re,ne,oe,ie,de,ce,ue,me,xe,pe,fe,ge,ve,he,je,be,we,ye,Ne,Ce,Se,_e,Ie,$e,Te;const Ue=Ze(),{transaction:t,incomeRelation:d}=Ue.state,m=ea(),Me=aa(),[g,Re]=s.useState((W=t.category)==null?void 0:W.id),[T,k]=s.useState(void 0),[Ve,Le]=s.useState(!1),[z,P]=s.useState(!1),[o,Ge]=s.useState((Z=(Y=t.card)==null?void 0:Y.type)==null?void 0:Z.id),[N,F]=s.useState((ee=t.card)==null?void 0:ee.id),[O,A]=s.useState(void 0),[Xe,D]=s.useState(!1),[q,E]=s.useState(!1),[C,Be]=s.useState((t==null?void 0:t.concept)??""),[v,U]=s.useState(`${(t.amount??0)<0?(t.amount??0)*-1:t.amount}`??""),[u,M]=s.useState(((ae=t.transaction_date)==null?void 0:ae.slice(0,10))??""),[R,h]=s.useState(((te=t.accounting_date)==null?void 0:te.slice(0,10))??""),[j,V]=s.useState(t.notes??""),[S,He]=s.useState(d?(le=(se=d.from_transaction)==null?void 0:se.card)==null?void 0:le.id:void 0),[_,Je]=s.useState(d?(ne=(re=d.to_transaction)==null?void 0:re.card)==null?void 0:ne.id:void 0),[L,G]=s.useState(void 0),[X,B]=s.useState(void 0),[Ke,Qe]=s.useState(!1),[We,Ye]=s.useState(!1),[x,H]=s.useState(!1),[J,K]=s.useState(!1),i=ze(e=>e.cards),c=ze(e=>e.transactions);s.useEffect(()=>{m(ta())},[m]),s.useEffect(()=>{if(c.updateSuccess!==null)if(c.updateSuccess){var e=c.data;Me("/dashboard/transaction",{state:{transaction:e}}),Pe({variant:"flat",color:"success",title:"Actualización exitosa",timeout:3e3,description:c.message}),m(Fe())}else Pe({variant:"flat",color:"danger",title:"Error",description:c.error}),m(Fe())},[c]);const Q=e=>{var l,r,n,ke;if(e.preventDefault(),((l=t.type)==null?void 0:l.id)===1&&((n=(r=t.card)==null?void 0:r.type)==null?void 0:n.id)===2||((ke=t.type)==null?void 0:ke.id)===3){if(G(S===void 0),B(_===void 0),L||X)return;const I={concept:C??"",amount:parseFloat(v??"0"),transaction_date:u??"",accounting_date:u??"",place:"",notes:j??"",category_id:g??0,card_id:_??0,second_card_id:S??void 0},$={id:t.id.toString(),data:I};m(De($))}else{if(k(g===void 0),A(N===void 0),T||O)return;const I={concept:C??"",amount:parseFloat(v??"0"),transaction_date:u??"",accounting_date:o===1?u??"":R??"",place:"",notes:j??"",category_id:g??0,card_id:N??0,second_card_id:void 0},$={id:t.id.toString(),data:I};m(De($))}};return((oe=t.type)==null?void 0:oe.id)===1&&((de=(ie=t.card)==null?void 0:ie.type)==null?void 0:de.id)===2||((ce=t.type)==null?void 0:ce.id)===3?a.jsx("form",{onSubmit:Q,className:"w-full flex flex-col gap-y-6 pb-12",children:a.jsxs("div",{className:"w-full flex flex-col gap-y-6",children:[a.jsx("span",{className:"font-semibold text-center",children:"Editar movimiento"}),a.jsx("div",{className:"w-full lg:w-1/3",children:a.jsx(ra,{classname:"!justify-start gap-x-2",name:"Tipo de movimiento:",value:((ue=t.type)==null?void 0:ue.type)=="INCOME"?"Ingreso":((me=t.type)==null?void 0:me.type)=="EXPENSE"?"Gasto":"Pago de TDC"})}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-y-6 gap-x-4",children:[a.jsx("div",{className:"w-full flex flex-row gap-x-4 justify-between items-end",children:Ke?a.jsx(w,{required:!0,size:"lg",variant:"flat",label:"Tarjeta origen",labelPlacement:"outside",placeholder:"Tarjeta",value:S,color:L?"danger":void 0,className:"w-full",isOpen:x,onOpenChange:e=>e!==x&&H(e),onChange:e=>{He(parseInt(e.target.value)),G(e.target.value===void 0)},children:i.debit&&i.debit.map(e=>{var l,r,n;return a.jsx(f,{endContent:a.jsx("div",{className:`p-2 w-10 max-h-6 flex flex-col justify-center items-center rounded-md ${((l=e.network)==null?void 0:l.name)==="Visa"?"bg-blue-700":"bg-gray-200"}`,children:a.jsx("img",{src:`${y}${(r=e.network)==null?void 0:r.img_path}`,alt:""})}),children:`${(n=e.bank)==null?void 0:n.name} ${e.numbers}`},e.id)})}):a.jsxs("div",{className:"w-full flex-col space-y-1",children:[a.jsx("span",{className:"text-sm",children:"Tarjeta origen"}),a.jsxs("div",{onClick:()=>{Qe(!0),H(!x)},className:"w-full h-12 bg-neutral-100 hover:bg-neutral-200 px-3 py-2 rounded-xl text-slate-600 flex flex-row justify-between items-center cursor-pointer",children:[a.jsx("span",{className:"text-sm",children:`${(fe=(pe=(xe=d.from_transaction)==null?void 0:xe.card)==null?void 0:pe.bank)==null?void 0:fe.name} ${(ve=(ge=d.from_transaction)==null?void 0:ge.card)==null?void 0:ve.numbers}`}),a.jsx(b,{name:"FaChevronDown",size:11})]})]})}),a.jsx("div",{className:"w-full flex flex-row gap-x-4 justify-between items-end",children:We?a.jsx(w,{required:!0,size:"lg",variant:"flat",label:"Tarjeta destino",labelPlacement:"outside",placeholder:"Tarjeta",value:_,color:X?"danger":void 0,className:"w-full",isOpen:J,onOpenChange:e=>e!==J&&K(e),onChange:e=>{Je(parseInt(e.target.value)),B(e.target.value===void 0)},children:i.credit&&i.credit.map(e=>{var l,r,n;return a.jsx(f,{endContent:a.jsx("div",{className:`p-2 w-10 max-h-6 flex flex-col justify-center items-center rounded-md ${((l=e.network)==null?void 0:l.name)==="Visa"?"bg-blue-700":"bg-gray-200"}`,children:a.jsx("img",{src:`${y}${(r=e.network)==null?void 0:r.img_path}`,alt:""})}),children:`${(n=e.bank)==null?void 0:n.name} ${e.numbers}`},e.id)})}):a.jsxs("div",{className:"w-full flex-col space-y-1",children:[a.jsx("span",{className:"text-sm",children:"Tarjeta destino"}),a.jsxs("div",{onClick:()=>{Ye(!0),K(!x)},className:"w-full h-12 bg-neutral-100 hover:bg-neutral-200 px-3 py-2 rounded-xl text-slate-600 flex flex-row justify-between items-center cursor-pointer",children:[a.jsx("span",{className:"text-sm",children:`${(be=(je=(he=d.to_transaction)==null?void 0:he.card)==null?void 0:je.bank)==null?void 0:be.name} ${(ye=(we=d.to_transaction)==null?void 0:we.card)==null?void 0:ye.numbers}`}),a.jsx(b,{name:"FaChevronDown",size:11})]})]})})]}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-y-6 gap-x-4",children:[a.jsx(p,{required:!0,size:"lg",variant:"bordered",label:"Monto",labelPlacement:"outside",placeholder:"20000",type:"number",inputMode:"decimal",startContent:"$",value:v,onChange:e=>U(e.target.value),className:"w-full"}),a.jsx(p,{required:!0,size:"lg",variant:"bordered",label:"Fec. movimiento",labelPlacement:"outside",type:"date",value:u,onChange:e=>{M(e.target.value),o===1&&h(e.target.value)},className:"min-w-1 w-full"})]}),a.jsx(qe,{size:"lg",variant:"bordered",label:"Notas",labelPlacement:"outside",placeholder:"Notas",type:"text",value:j,onChange:e=>V(e.target.value)}),a.jsx(Oe,{size:"lg",type:"submit",variant:"solid",color:"primary",radius:"lg",className:"w-full bg-gradient-to-r from-blue-500 via-cyan-500 to-teal-500 mt-6 text-medium",isLoading:c.loading,children:"Registrar"})]})}):a.jsx("form",{onSubmit:Q,className:"w-full flex flex-col gap-y-6 pb-12",children:a.jsxs("div",{className:"w-full flex flex-col gap-y-6",children:[a.jsx("span",{className:"font-semibold text-center",children:"Editar movimiento"}),a.jsx("span",{className:"font-medium text-center",children:"Información general"}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-y-6 gap-x-4 items-end",children:[a.jsx("div",{className:"w-full lg:w-1/3",children:Ve?a.jsx(w,{required:!0,size:"lg",variant:"flat",label:"Categoría",labelPlacement:"outside",placeholder:"Categoría",value:g,color:T?"danger":void 0,className:"w-full",isOpen:z,onOpenChange:e=>e!==z&&P(e),onChange:e=>{Re(parseInt(e.target.value)),k(e.target.value===void 0)},children:sa.map(e=>a.jsx(f,{children:e.label},e.key))}):a.jsxs("div",{className:"w-full flex-col space-y-1",children:[a.jsx("span",{className:"text-sm",children:"Categoría"}),a.jsxs("div",{onClick:()=>{Le(!0),P(!x)},className:"w-full h-12 bg-neutral-100 hover:bg-neutral-200 px-3 py-2 rounded-xl text-slate-600 flex flex-row justify-between items-center cursor-pointer",children:[a.jsx("span",{className:"text-sm",children:(Ne=t.category)==null?void 0:Ne.name}),a.jsx(b,{name:"FaChevronDown",size:11})]})]})}),a.jsxs("div",{className:"w-full lg:w-8/12 flex flex-col lg:flex-row gap-y-6 gap-x-4",children:[a.jsx(na,{size:"lg",label:"Tipo de tarjeta",orientation:"horizontal",value:o==null?void 0:o.toString(),onChange:e=>{const l=parseInt(e.target.value);Ge(l),F(void 0),l===1&&h(u),D(!0)},className:"text-sm w-full",children:a.jsxs("div",{className:"flex w-full justify-start lg:justify-between space-x-6 lg:space-x-0",children:[((Ce=t.type)==null?void 0:Ce.id)!==1&&la.map(e=>a.jsx(Ee,{value:e.key.toString(),children:e.label},e.key)),((Se=t.type)==null?void 0:Se.id)===1&&a.jsx(Ee,{value:"1",children:"Débito"},1)]})}),a.jsx("div",{className:"w-full",children:i.loading?a.jsxs("div",{className:"w-full h-16 flex flex-col justify-between",children:[a.jsx(Ae,{className:"w-12 h-4 rounded-xl",children:"a"}),a.jsx(Ae,{className:"w-full h-10 rounded-xl",children:"a"})]}):a.jsx(a.Fragment,{children:i.error!==null?a.jsx("div",{children:i.error}):a.jsx(a.Fragment,{children:Xe?a.jsx(w,{required:!0,size:"lg",variant:"flat",label:"Tarjeta",labelPlacement:"outside",placeholder:"Tarjeta",value:N,color:O?"danger":void 0,className:"w-full",isOpen:q,onOpenChange:e=>e!==q&&E(e),onChange:e=>{F(parseInt(e.target.value)),A(e.target.value===void 0)},children:o===1&&Array.isArray(i.debit)?i.debit.map(e=>{var l,r,n;return a.jsx(f,{endContent:a.jsx("div",{className:`p-2 w-10 max-h-6 flex flex-col justify-center items-center rounded-md ${((l=e.network)==null?void 0:l.name)==="Visa"?"bg-blue-700":"bg-gray-200"}`,children:a.jsx("img",{src:`${y}${(r=e.network)==null?void 0:r.img_path}`,alt:""})}),children:`${(n=e.bank)==null?void 0:n.name} ${e.numbers}`},e.id)}):o===2&&Array.isArray(i.credit)?i.credit.map(e=>{var l,r,n;return a.jsx(f,{endContent:a.jsx("div",{className:`p-2 w-10 max-h-6 flex flex-col justify-center items-center rounded-md ${((l=e.network)==null?void 0:l.name)==="Visa"?"bg-blue-700":"bg-gray-200"}`,children:a.jsx("img",{src:`${y}${(r=e.network)==null?void 0:r.img_path}`,alt:""})}),children:`${(n=e.bank)==null?void 0:n.name} ${e.numbers}`},e.id)}):null}):a.jsxs("div",{className:"w-full flex-col space-y-1",children:[a.jsx("span",{className:"text-sm",children:"Tarjeta"}),a.jsxs("div",{onClick:()=>{D(!0),E(!x)},className:"w-full h-12 bg-neutral-100 hover:bg-neutral-200 px-3 py-2 rounded-xl text-slate-600 flex flex-row justify-between items-center cursor-pointer",children:[a.jsx("span",{className:"text-sm",children:`${(Ie=(_e=t.card)==null?void 0:_e.bank)==null?void 0:Ie.name} ${($e=t.card)==null?void 0:$e.numbers}`}),a.jsx(b,{name:"FaChevronDown",size:11})]})]})})})})]})]}),a.jsxs("div",{className:"w-full flex flex-col gap-y-6",children:[a.jsx("span",{className:"font-medium text-center",children:"Detalle"}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-y-6 gap-x-4",children:[((Te=t.type)==null?void 0:Te.id)!==3&&a.jsx(p,{required:!0,size:"lg",variant:"bordered",label:"Concepto",labelPlacement:"outside",placeholder:"Pago de Nómina",type:"text",value:C,onChange:e=>Be(e.target.value)}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-y-6 gap-x-4",children:[a.jsx(p,{required:!0,size:"lg",variant:"bordered",label:"Monto",labelPlacement:"outside",placeholder:"20000",type:"number",inputMode:"decimal",startContent:"$",value:v,onChange:e=>U(e.target.value),className:"w-full lg:w-5/12"}),a.jsxs("div",{className:"w-full flex flex-row gap-x-4 justify-between",children:[a.jsx(p,{required:!0,size:"lg",variant:"bordered",label:"Fec. movimiento",labelPlacement:"outside",type:"date",value:u,onChange:e=>{M(e.target.value),o===1&&h(e.target.value)},className:`min-w-1 w-1/2 ${o===1?"pr-3":"pr-0"}`}),a.jsx(p,{required:!0,disabled:o===1,size:"lg",variant:"bordered",label:"Fec. contabilidad",labelPlacement:"outside",type:"date",value:R,onChange:e=>h(e.target.value),className:`min-w-1 w-1/2 ${o===1?"text-neutral-300 hidden":""}`})]})]})]}),a.jsx(qe,{size:"lg",variant:"bordered",label:"Notas",labelPlacement:"outside",placeholder:"Notas",type:"text",value:j,onChange:e=>V(e.target.value)}),a.jsx(Oe,{size:"lg",type:"submit",variant:"solid",color:"primary",radius:"lg",className:"w-full lg:w-1/6",isLoading:c.loading,children:"Actualizar"})]})]})})};export{ga as default};
