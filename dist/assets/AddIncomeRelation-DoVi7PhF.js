import{h as Z,u as B,a as H,b as m,r as t,V as f,i as J,X as K,g as O,c as g,Y as Q,j as a,s as v,f as j,e as W,Z as ee}from"./index-DKY2NX35.js";import{s as F,l as $}from"./chunk-2GIFKCNQ-y7tds759.js";import{t as ae}from"./chunk-RIE4DNUQ-Ba9WOTQ8.js";const te="https://nimo-api.paulflores.site",ce=()=>{var P,E;const T=Z(),{transaction:o}=T.state,s=B(),k=H(),{message:se,verified:x,stored:p,item:le,error:N,loading:oe}=m(e=>e.income_relations),{debit:_,loading:D,error:w}=m(e=>e.cards),r=m(e=>e.transactions),n=m(e=>e.contacts),[i,L]=t.useState(void 0),[h,M]=t.useState(void 0),[C,V]=t.useState(o.concept??void 0),[d,G]=t.useState(void 0),[b,U]=t.useState((P=o.accounting_date)==null?void 0:P.slice(0,10)),[y,X]=t.useState(void 0),[S,R]=t.useState(void 0),[q,I]=t.useState(void 0),[u,c]=t.useState(!1);t.useEffect(()=>{s(f()),s(J()),s(K())},[s]),t.useEffect(()=>{if(x!==null&&u)if(x){const e={concept:C??"",amount:parseFloat(d??"0"),transaction_date:b??"",accounting_date:b??"",place:"",notes:y??"",category_id:12,type_id:1,card_id:h??0,second_card_id:void 0};s(O(e))}else g({variant:"flat",color:"danger",title:"Error",description:N}),c(!1),s(f())},[x]),t.useEffect(()=>{if(u){if(r.error)g({variant:"flat",color:"danger",title:"Error",description:r.error}),c(!1),s(f());else if(r.message){const e=r.data,l={amount:parseFloat(d??"0"),contact_id:i,from_id:e==null?void 0:e.id,to_id:o.id};s(Q(l))}}},[r]),t.useEffect(()=>{u&&(p!==null&&(console.log("entre aqui null"),s(f()),p?(g({variant:"flat",color:"success",title:"Registro exitoso",timeout:5e3}),k("/dashboard/transaction",{state:{transaction:o}})):g({variant:"flat",color:"danger",title:"Error",description:N})),c(!1))},[p]);const Y=e=>{if(e.preventDefault(),c(!0),R(h===void 0),I(i===void 0),S&&q){c(!1);return}const l={amount:parseFloat(d??"0"),to_id:o.id};s(ee(l))};return a.jsxs("form",{onSubmit:Y,className:"flex flex-col items-center justify-center gap-y-6 pb-12",children:[a.jsx("div",{className:"w-full",children:a.jsx("span",{className:"font-medium",children:"Agregar ingreso vinculado"})}),a.jsxs("div",{className:"w-full flex flex-col lg:flex-row gap-6",children:[n.loading?a.jsxs("div",{className:"w-full h-16 flex flex-col justify-between",children:[a.jsx(v,{className:"w-28 h-4 rounded-xl",children:"a"}),a.jsx(v,{className:"w-full h-10 rounded-xl",children:"a"})]}):a.jsx(a.Fragment,{children:n.error!==null?a.jsx("div",{children:n.error}):a.jsx(a.Fragment,{children:(E=n.collection)!=null&&E.data?a.jsx(F,{required:!0,size:"lg",variant:"flat",label:"Contacto",labelPlacement:"outside",placeholder:"Contacto",value:i==null?void 0:i.toString(),color:q?"danger":void 0,className:"w-full",onChange:e=>{const l=parseInt(e.target.value);L(l),I(isNaN(l))},children:n.collection.data.map(e=>a.jsx($,{children:e.alias},e.id))}):null})}),D?a.jsxs("div",{className:"w-full h-16 flex flex-col justify-between",children:[a.jsx(v,{className:"w-28 h-4 rounded-xl",children:"a"}),a.jsx(v,{className:"w-full h-10 rounded-xl",children:"a"})]}):a.jsx(a.Fragment,{children:w!==null?a.jsx("div",{children:w}):a.jsx(F,{required:!0,size:"lg",variant:"flat",label:"Tarjeta de débito",labelPlacement:"outside",placeholder:"Tarjeta",value:h,color:S?"danger":void 0,className:"w-full",onChange:e=>{M(parseInt(e.target.value)),R(e.target.value===void 0)},children:_&&_.map(e=>{var l,z,A;return a.jsx($,{endContent:a.jsx("div",{className:`p-2 w-10 max-h-6 flex flex-col justify-center items-center rounded-md ${((l=e.network)==null?void 0:l.name)==="Visa"?"bg-blue-700":"bg-gray-200"}`,children:a.jsx("img",{src:`${te}${(z=e.network)==null?void 0:z.img_path}`,alt:""})}),children:`${(A=e.bank)==null?void 0:A.name} ${e.numbers}`},e.id)})})})]}),a.jsx(j,{required:!0,size:"lg",variant:"bordered",label:"Concepto",labelPlacement:"outside",placeholder:"Pago de Nómina",type:"text",value:C,onChange:e=>V(e.target.value)}),a.jsx(j,{required:!0,size:"lg",variant:"bordered",label:"Monto",labelPlacement:"outside",placeholder:"20000",type:"number",inputMode:"decimal",startContent:"$",value:d,onChange:e=>G(e.target.value)}),a.jsx("div",{className:"w-full",children:a.jsx(j,{required:!0,size:"lg",variant:"bordered",label:"Fec. movimiento",labelPlacement:"outside",type:"date",value:b,onChange:e=>{U(e.target.value)},className:"min-w-1 w-1/2"})}),a.jsx(ae,{size:"lg",variant:"bordered",label:"Notas",labelPlacement:"outside",placeholder:"Notas",type:"text",value:y,onChange:e=>X(e.target.value)}),a.jsx(W,{size:"lg",type:"submit",variant:"solid",color:"primary",radius:"lg",className:"w-full bg-gradient-to-r from-blue-500 via-cyan-500 to-teal-500 mt-6",isLoading:u,children:"Registrar"})]})};export{ce as default};
